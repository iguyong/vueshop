import{_ as D,r as u,l as c,s as y,c as r,b as v,a as e,p as I,t as s,i as _,q as N,F as P,j as B,w as C,x as F,o as n}from"./index-D3VJuQVs.js";import{p as S}from"./product-placeholder-CDHWcwM5.js";const V={class:"checkout-container"},$={key:0,class:"loading-overlay"},L={key:1,class:"error-alert"},q={key:2,class:"order-details"},j={class:"order-summary"},A={class:"order-meta"},E={class:"order-items"},M=["src","alt"],R={class:"item-info"},T={class:"payment-section"},U={class:"amount-summary"},z={class:"total-amount"},G={key:0,class:"action-buttons"},H=["disabled"],J={__name:"OrderDetail",props:["orderId"],setup(f){const p=N(),b=u(!1),m=u(null),d=u(!1),g=u(0),h=u("wechat"),a=c(()=>y.getOrderById(f.orderId)),k=c(()=>y.formattedOrderNumber()),O=c(()=>{var l;return new Date((l=a.value)==null?void 0:l.createdAt).toLocaleString()}),w=c(()=>(console.log("currentOrder:",a.value),a.value?a.value.status==="paid"?"已支付":"待支付":"")),i=l=>Number(l).toFixed(2),x=async()=>{try{d.value=!0,await y.processPayment(a.value.id)&&p.push(`/payment-success/${f.orderId}`)}catch(l){m.value=`支付失败: ${l.message}`}finally{d.value=!1}};return(l,t)=>(n(),r("div",V,[b.value?(n(),r("div",$,t[3]||(t[3]=[e("div",{class:"loader"},null,-1)]))):v("",!0),m.value?(n(),r("div",L,[I(s(m.value)+" ",1),e("button",{onClick:t[0]||(t[0]=o=>_(p).push("/cart"))},"返回购物车")])):v("",!0),a.value?(n(),r("div",q,[t[7]||(t[7]=e("h1",{class:"order-title"},"订单详情",-1)),e("div",j,[e("div",A,[e("p",null,"订单编号："+s(k.value),1),e("p",null,"下单时间："+s(O.value),1),e("p",null,"订单状态："+s(w.value),1)]),e("div",E,[t[4]||(t[4]=e("h2",null,"商品清单",-1)),(n(!0),r(P,null,B(a.value.items,o=>(n(),r("div",{key:o.id,class:"order-item"},[e("img",{src:o.image||_(S),alt:o.name,class:"product-image"},null,8,M),e("div",R,[e("h3",null,s(o.name),1),e("p",null,"单价：¥"+s(i(o.price)),1),e("p",null,"数量："+s(o.quantity),1)])]))),128))]),e("div",T,[t[6]||(t[6]=e("h2",null,"支付方式",-1)),C(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>h.value=o),class:"payment-select"},t[5]||(t[5]=[e("option",{value:"wechat"},"微信支付",-1),e("option",{value:"alipay"},"支付宝",-1),e("option",{value:"credit"},"信用卡",-1)]),512),[[F,h.value]])]),e("div",U,[e("p",null,"商品总额：¥"+s(i(a.value.total)),1),e("p",null,"运费：¥"+s(i(g.value)),1),e("p",z,"应付总额：¥"+s(i(a.value.total+g.value)),1)]),a.value.status=="toPay"?(n(),r("div",G,[e("button",{onClick:x,disabled:d.value,class:"pay-button"},s(d.value?"支付处理中...":"立即支付"),9,H),e("button",{onClick:t[2]||(t[2]=o=>_(p).push("/")),class:"continue-shopping"},"继续购物")])):v("",!0)])])):v("",!0)]))}},W=D(J,[["__scopeId","data-v-aff10a41"]]);export{W as default};
