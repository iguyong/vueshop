import{_ as D,f as I,r as u,p as c,c as r,b as v,a as e,q as N,t as s,j as _,s as P,F as S,k as B,w as C,x as F,o as n}from"./index-Bv4Am3CP.js";import{p as V}from"./product-placeholder-CDHWcwM5.js";const $={class:"checkout-container"},L={key:0,class:"loading-overlay"},q={key:1,class:"error-alert"},j={key:2,class:"order-details"},A={class:"order-summary"},E={class:"order-meta"},M={class:"order-items"},R=["src","alt"],T={class:"item-info"},U={class:"payment-section"},z={class:"amount-summary"},G={class:"total-amount"},H={key:0,class:"action-buttons"},J=["disabled"],K={__name:"OrderDetail",props:["orderId"],setup(f){const p=I(),m=P(),b=u(!1),y=u(null),d=u(!1),h=u(0),g=u("wechat"),a=c(()=>p.getOrderById(f.orderId)),k=c(()=>p.formattedOrderNumber()),O=c(()=>{var l;return new Date((l=a.value)==null?void 0:l.createdAt).toLocaleString()}),w=c(()=>(console.log("currentOrder:",a.value),a.value?a.value.status==="paid"?"已支付":"待支付":"")),i=l=>Number(l).toFixed(2),x=async()=>{try{d.value=!0,await p.processPayment(a.value.id)&&m.push(`/payment-success/${f.orderId}`)}catch(l){y.value=`支付失败: ${l.message}`}finally{d.value=!1}};return(l,t)=>(n(),r("div",$,[b.value?(n(),r("div",L,t[3]||(t[3]=[e("div",{class:"loader"},null,-1)]))):v("",!0),y.value?(n(),r("div",q,[N(s(y.value)+" ",1),e("button",{onClick:t[0]||(t[0]=o=>_(m).push("/cart"))},"返回购物车")])):v("",!0),a.value?(n(),r("div",j,[t[7]||(t[7]=e("h1",{class:"order-title"},"订单详情",-1)),e("div",A,[e("div",E,[e("p",null,"订单编号："+s(k.value),1),e("p",null,"下单时间："+s(O.value),1),e("p",null,"订单状态："+s(w.value),1)]),e("div",M,[t[4]||(t[4]=e("h2",null,"商品清单",-1)),(n(!0),r(S,null,B(a.value.items,o=>(n(),r("div",{key:o.id,class:"order-item"},[e("img",{src:o.image||_(V),alt:o.name,class:"product-image"},null,8,R),e("div",T,[e("h3",null,s(o.name),1),e("p",null,"单价：¥"+s(i(o.price)),1),e("p",null,"数量："+s(o.quantity),1)])]))),128))]),e("div",U,[t[6]||(t[6]=e("h2",null,"支付方式",-1)),C(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>g.value=o),class:"payment-select"},t[5]||(t[5]=[e("option",{value:"wechat"},"微信支付",-1),e("option",{value:"alipay"},"支付宝",-1),e("option",{value:"credit"},"信用卡",-1)]),512),[[F,g.value]])]),e("div",z,[e("p",null,"商品总额：¥"+s(i(a.value.total)),1),e("p",null,"运费：¥"+s(i(h.value)),1),e("p",G,"应付总额：¥"+s(i(a.value.total+h.value)),1)]),a.value.status=="toPay"?(n(),r("div",H,[e("button",{onClick:x,disabled:d.value,class:"pay-button"},s(d.value?"支付处理中...":"立即支付"),9,J),e("button",{onClick:t[2]||(t[2]=o=>_(m).push("/")),class:"continue-shopping"},"继续购物")])):v("",!0)])])):v("",!0)]))}},X=D(K,[["__scopeId","data-v-2bbee29e"]]);export{X as default};
